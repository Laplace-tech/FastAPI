<!-- docs/concepts/06-testing-ci.md -->
# 테스트 전략 + CI 파이프라인 (포트폴리오/운영 관점)

## 1) 목표
- 기능이 늘어나도 “핵심 흐름”이 깨지지 않게 자동으로 보장한다.
- PR/Push 때마다 테스트가 돌아서, 깨진 코드를 main에 못 올리게 한다.

---

## 2) 테스트 레벨(현실적인 구성)
### (1) Smoke Test (필수)
- register/login 성공
- 토큰으로 보호 엔드포인트 200
이건 “서비스 생명선”이다.

### (2) Negative Auth Tests (필수)
- 잘못된 비번 401
- 위조/만료 토큰 401
- 로그아웃 후 기존 토큰 401(token_version이면 강력)

### (3) Documents 권한 테스트 (필수)
- 다른 유저 문서 접근 시 403/404
이게 없으면 “개인 문서 서비스”로서 신뢰가 무너진다.

---

## 3) 테스트 데이터/DB 전략
- 테스트는 독립적으로 돌아야 한다(실행 순서 의존 X).
- 가장 흔한 선택:
  - SQLite(테스트 전용) + 매 테스트마다 초기화
  - 또는 Testcontainers로 Postgres 띄우기(운영과 동일 환경, 난이도↑)

포트폴리오 초반은 SQLite로 시작하고,
M6쯤 운영 환경(Postgres)로 전환하며 Testcontainers를 붙이면 스토리가 좋다.

---

## 4) CI에서 최소로 돌릴 것
- ruff(린트) + black(포맷 체크)
- pytest

실무 팁:
- “로컬에서는 black이 자동”, “CI에서는 black --check로 검증”
- 느린 테스트는 표시해서 분리(나중에)

---

## 5) GitHub Actions가 제공하는 가치(면접 포인트)
- “push 때마다 자동 검증”이 있다는 건 운영 품질의 출발점
- 테스트가 문서화된 요구사항(스펙) 역할을 한다
